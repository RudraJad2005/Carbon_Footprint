{% extends "index.html" %}

{% block content %}
<header class="bg-white text-black-100 fixed w-full top-0 z-50">
    {% include 'navbar.html' %}
</header>

<div class="pt-24 flex justify-center">
    <div class="max-w-lg w-full p-6 bg-white rounded-lg shadow-md">
        <!-- Form -->
        <form method="post" action="{% url 'carbon_footprint_view' %}">
            {% csrf_token %}

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Row 1 -->
                <div class="flex items-center border-b border-gray-300 pb-6">
                    <div class="flex-grow relative">
                        <label for="electricity" class="block text-sm font-medium text-gray-700">
                            Electricity
                            <span class="absolute top-0 right-0 ml-2 text-gray-500 cursor-pointer group">
                                ?
                                <span class="tooltip hidden absolute bg-gray-700 text-white text-xs rounded py-1 px-2">
                                    Electricity consumed in kWh.
                                </span>
                            </span>
                        </label>
                        <input type="number" name="electricity" id="electricity" autocomplete="off"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <div class="relative inline-block text-left ml-4">
                        <select name="electricity_unit" id="electricity_unit"
                            class="block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-2 px-3 pr-8 rounded leading-tight focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            <option value="kWh">kWh</option>
                            <option value="kg">kg</option>
                        </select>
                    </div>
                </div>

                <div class="flex items-center border-b border-gray-300 pb-6">
                    <div class="flex-grow relative">
                        <label for="natural_gas" class="block text-sm font-medium text-gray-700">
                            Natural Gas
                            <span class="absolute top-0 right-0 ml-2 text-gray-500 cursor-pointer group">
                                ?
                                <span class="tooltip hidden absolute bg-gray-700 text-white text-xs rounded py-1 px-2">
                                    Natural gas consumed in kWh.
                                </span>
                            </span>
                        </label>
                        <input type="number" name="natural_gas" id="natural_gas" autocomplete="off"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <div class="relative inline-block text-left ml-4">
                        <select name="natural_gas_unit" id="natural_gas_unit"
                            class="block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-2 px-3 pr-8 rounded leading-tight focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            <option value="kWh">kWh</option>
                            <option value="kg">kg</option>
                        </select>
                    </div>
                </div>

                <div class="flex items-center border-b border-gray-300 pb-6">
                    <div class="flex-grow relative">
                        <label for="biomass" class="block text-sm font-medium text-gray-700">
                            Biomass
                            <span class="absolute top-0 right-0 ml-2 text-gray-500 cursor-pointer group">
                                ?
                                <span class="tooltip hidden absolute bg-gray-700 text-white text-xs rounded py-1 px-2">
                                    Biomass consumed in kWh.
                                </span>
                            </span>
                        </label>
                        <input type="number" name="biomass" id="biomass" autocomplete="off"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <div class="relative inline-block text-left ml-4">
                        <select name="biomass_unit" id="biomass_unit"
                            class="block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-2 px-3 pr-8 rounded leading-tight focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            <option value="kWh">kWh</option>
                            <option value="kg">kg</option>
                        </select>
                    </div>
                </div>

                <!-- Row 2 -->
                <div class="flex items-center border-b border-gray-300 pb-6">
                    <div class="flex-grow relative">
                        <label for="coal" class="block text-sm font-medium text-gray-700">
                            Coal
                            <span class="absolute top-0 right-0 ml-2 text-gray-500 cursor-pointer group">
                                ?
                                <span class="tooltip hidden absolute bg-gray-700 text-white text-xs rounded py-1 px-2">
                                    Coal consumed in kWh.
                                </span>
                            </span>
                        </label>
                        <input type="number" name="coal" id="coal" autocomplete="off"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <div class="relative inline-block text-left ml-4">
                        <select name="coal_unit" id="coal_unit"
                            class="block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-2 px-3 pr-8 rounded leading-tight focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            <option value="kWh">kWh</option>
                            <option value="kg">kg</option>
                        </select>
                    </div>
                </div>

                <div class="flex items-center border-b border-gray-300 pb-6">
                    <div class="flex-grow relative">
                        <label for="heating_oil" class="block text-sm font-medium text-gray-700">
                            Heating Oil
                            <span class="absolute top-0 right-0 ml-2 text-gray-500 cursor-pointer group">
                                ?
                                <span class="tooltip hidden absolute bg-gray-700 text-white text-xs rounded py-1 px-2">
                                    Heating oil consumed in kWh or liters.
                                </span>
                            </span>
                        </label>
                        <input type="number" name="heating_oil" id="heating_oil" autocomplete="off"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <div class="relative inline-block text-left ml-4">
                        <select name="heating_oil_unit" id="heating_oil_unit"
                            class="block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-2 px-3 pr-8 rounded leading-tight focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            <option value="kWh">kWh</option>
                            <option value="kg">kg</option>
                            <option value="liters">Liters</option>
                        </select>
                    </div>
                </div>

                <div class="flex items-center border-b border-gray-300 pb-6">
                    <div class="flex-grow relative">
                        <label for="lpg" class="block text-sm font-medium text-gray-700">
                            LPG
                            <span class="absolute top-0 right-0 ml-2 text-gray-500 cursor-pointer group">
                                ?
                                <span class="tooltip hidden absolute bg-gray-700 text-white text-xs rounded py-1 px-2">
                                    LPG consumed in kWh or liters.
                                </span>
                            </span>
                        </label>
                        <input type="number" name="lpg" id="lpg" autocomplete="off"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <div class="relative inline-block text-left ml-4">
                        <select name="lpg_unit" id="lpg_unit"
                            class="block appearance-none w-full bg-white border border-gray-300 text-gray-700 py-2 px-3 pr-8 rounded leading-tight focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            <option value="kWh">kWh</option>
                            <option value="kg">kg</option>
                            <option value="liters">Liters</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="pt-5">
                <div class="flex justify-end">
                    <button type="submit"
                        class="ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Calculate
                    </button>
                </div>
            </div>
        </form>

        <button type="submit"
            class="ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            Offset
        </button>
    </div>
</div>



<!-- Add this to your HTML file -->
<div id="popup-message"
    class="fixed top-0 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white p-4 rounded-lg shadow-lg z-50 hidden">
    <p>This is a pop-up message. It will appear every time you visit the website.</p>
    <button id="close-popup" class="absolute top-2 right-2 bg-gray-900 text-white p-1 rounded-full hover:bg-gray-700">
        &times;
    </button>
</div>


<style>
    .group:hover .tooltip {
        display: block;
    }

    .tooltip {
        display: none;
        top: 100%;
        right: 0;
        transform: translateY(0.5rem);
        z-index: 10;
    }

    /* Add this to your CSS file */
    #popup-message {
        display: none;
        /* hide the popup by default */
    }

    #popup-message.show {
        display: block;
        /* show the popup when the show class is added */
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Function to handle unit change
        function handleUnitChange(event) {
            const dropdownButton = event.target.closest('.dropdown-button');
            const selectedUnit = event.target.getAttribute('data-value');

            // Update the dropdown button with the selected unit
            dropdownButton.querySelector('.selected-unit').textContent = selectedUnit;

            // Hide the dropdown menu after selection
            dropdownButton.nextElementSibling.classList.add('hidden');
        }

        // Attach event listeners to all dropdown items
        document.querySelectorAll('.dropdown-item').forEach(item => {
            item.addEventListener('click', handleUnitChange);
        });

        // Function to toggle dropdown menu visibility
        function toggleDropdownMenu(event) {
            const dropdownMenu = event.target.closest('.dropdown-button').nextElementSibling;
            dropdownMenu.classList.toggle('hidden');
        }

        // Attach event listeners to all dropdown buttons
        document.querySelectorAll('.dropdown-button').forEach(button => {
            button.addEventListener('click', toggleDropdownMenu);
        });

        // Close dropdown if clicked outside
        document.addEventListener('click', function (event) {
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                if (!menu.contains(event.target) && !menu.previousElementSibling.contains(event.target)) {
                    menu.classList.add('hidden');
                }
            });
        });
    });


    // check if the user has visited the website before
    if (!localStorage.getItem("visited")) {
        // show the popup when the page loads
        document.getElementById("popup-message").classList.add("show");
        // set a flag to indicate that the user has visited the website
        localStorage.setItem("visited", true);
    } else {
        // if the user has visited the website before, only show the popup on page reload
        window.addEventListener("load", function () {
            // show the popup when the page loads
            document.getElementById("popup-message").classList.add("show");
        });
    }

    // add an event listener to the close button
    document.getElementById("close-popup").addEventListener("click", function () {
        // remove the show class to hide the popup
        document.getElementById("popup-message").classList.remove("show");
    });
</script>

{% endblock %}